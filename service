#!/usr/bin/env python

from hosted import device, node
import time

PINS = {
    'power': 18,
    'up': 23,
    'down': 22,
    'menu': 4,
    'select': 24
}

for name, pin in PINS.items():
    device.gpio.monitor(pin, pull_up=True)

last_event_time = {name: 0 for name in PINS}
debounce_delay = 0.2

for event in device.gpio.events():
    now = time.time()
    name = next((n for n, p in PINS.items() if p == event.pin), None)
    if name and event.value == 0 and now - last_event_time.get(name, 0) > debounce_delay:
        node.send("%s:0" % name)  -- Send e.g., "up:0" to match util.data_mapper
        last_event_time[name] = now
