#!/usr/bin/env python

from hosted import device, node
import time

# Your GPIO pins
PINS = {
    'power': 18,
    'up': 23,
    'down': 22,
    'menu': 4,
    'select': 24
}

# Monitor pins with pull-up (assuming active-low buttons)
for name, pin in PINS.items():
    device.gpio.monitor(pin, pull_up=True)

last_event_time = {name: 0 for name in PINS}
debounce_delay = 0.2  # 200ms debounce

for event in device.gpio.events():
    now = time.time()
    name = next((n for n, p in PINS.items() if p == event.pin), None)
    if name and event.value == 0 and now - last_event_time.get(name, 0) > debounce_delay:  # Button press (falling edge)
        node.send("/button:%s" % name)
        last_event_time[name] = now
